int ledPin = 13; // Pin LED is connected to
int piezoBuzzerPin = 10; // Pin Piezo Buzzer is connected to
int pirSensorPin = 9; // PIN PIR Sensor is connected to
int buttonPin = 6; // Button to turn alarm off
float sinVal;
int toneVal;
int motionDetected = LOW; // Start MotionDetected as low (No motiondetected)
int buttonStatus = LOW;
int alarmStatus = 0;

void setup() {
  pinMode(ledPin, OUTPUT); // declare LED as output
  pinMode(pirSensorPin, INPUT); // declare the PIR sensor as input
  pinMode(piezoBuzzerPin, OUTPUT); // declare buzzer as output
  pinMode(buttonPin, INPUT); // declare button as input
  Serial.begin(9600); // Set serial out if we want debugging
  delay(5000); // Allow time for the PIR Sensor to calibrate
}

void loop() {
  motionDetected = digitalRead(pirSensorPin); // READ the PIR sensor
  buttonStatus = digitalRead(buttonPin);
  
   if (motionDetected == HIGH || alarmStatus == 1) {
    Serial.println("motion detected!");
    alarmStatus = 1;     
    tone(piezoBuzzerPin, 52, 4000);
    tone(piezoBuzzerPin, 3000, 4000);
    digitalWrite(ledPin, HIGH);
    delay(500);
    //digitalWrite(ledPin, LOW);
    //delay(500);//	//
  }
  else if (motionDetected == LOW && alarmStatus == 0){
    Serial.println("NO motion!"); // NO motion detected
    digitalWrite(ledPin, LOW);
    digitalWrite(piezoBuzzerPin, LOW);
    noTone(piezoBuzzerPin);
  }
  
  
  if (buttonStatus == HIGH) {
  	alarmStatus = 0;
  }
  
  /*if (alarmStatus == 1)
  {
    digitalWrite(ledPin, HIGH);
    delay(500);
    digitalWrite(ledPin, LOW);
    delay(500);
  }*/
  
}

void loopLed(int led, int alarm)
{
  while(alarm == 1)
  {
    digitalWrite(led, HIGH);
    delay(500);
    digitalWrite(led, LOW);
    delay(500);
  }
}

